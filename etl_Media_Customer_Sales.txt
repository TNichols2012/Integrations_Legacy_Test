SELECT
"Month" = 'DMT Customer Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'DMT'
AND tSO.Item_State IN ('RT', 'PS', 'SH')

UNION ALL

SELECT
"Month" = 'DMT GR Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'DMT'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'GR'

UNION ALL

SELECT
"Month" = 'DMT GR Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'DMT'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'GR'

UNION ALL

SELECT
"Month" = 'DMT B1 Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'DMT'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B1'

UNION ALL

SELECT
"Month" = 'DMT B1 Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'DMT'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B1'

UNION ALL

SELECT
"Month" = 'DMT B2 Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'DMT'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B2'

UNION ALL

SELECT
"Month" = 'DMT B2 Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'DMT'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B2'

UNION ALL

SELECT
"Month" = 'DMT B3 Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'DMT'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B3'

UNION ALL

SELECT
"Month" = 'DMT B3 Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'DMT'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B3'

UNION ALL

SELECT
"Month" = 'DMT Other Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'DMT'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type NOT IN ('GR', 'B1', 'B2', 'B3')

UNION ALL

SELECT
"Month" = 'DMT Other Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'DMT'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type NOT IN ('GR', 'B1', 'B2', 'B3')

UNION ALL

--SELECT 
--"Month" = 'Month_Year',
--dbo.Get_TheMonth_Name (DATEADD(month, -13,GetDate()))+ ' ' + CONVERT(varchar(4), Year(DATEADD(month, -13, GetDate())))  AS Month_13,
--dbo.Get_TheMonth_Name (DATEADD(month, -12,GetDate()))+ ' ' + CONVERT(varchar(4), Year(DATEADD(month, -12, GetDate())))  AS Month_12,
--dbo.Get_TheMonth_Name (DATEADD(month, -11,GetDate()))+ ' ' + CONVERT(varchar(4), Year(DATEADD(month, -11, GetDate())))  AS Month_11,
--dbo.Get_TheMonth_Name (DATEADD(month, -10,GetDate()))+ ' ' + CONVERT(varchar(4), Year(DATEADD(month, -10, GetDate())))  AS Month_10,
--dbo.Get_TheMonth_Name (DATEADD(month, -9,GetDate()))+ ' ' + CONVERT(varchar(4), Year(DATEADD(month, -9, GetDate())))  AS Month_9,
--dbo.Get_TheMonth_Name (DATEADD(month, -8,GetDate()))+ ' ' + CONVERT(varchar(4), Year(DATEADD(month, -8, GetDate())))  AS Month_8,
--dbo.Get_TheMonth_Name (DATEADD(month, -7,GetDate()))+ ' ' + CONVERT(varchar(4), Year(DATEADD(month, -7, GetDate())))  AS Month_7,
--dbo.Get_TheMonth_Name (DATEADD(month, -6,GetDate()))+ ' ' + CONVERT(varchar(4), Year(DATEADD(month, -6, GetDate())))  AS Month_6,
--dbo.Get_TheMonth_Name (DATEADD(month, -5,GetDate()))+ ' ' + CONVERT(varchar(4), Year(DATEADD(month, -5, GetDate())))  AS Month_5,
--dbo.Get_TheMonth_Name (DATEADD(month, -4,GetDate()))+ ' ' + CONVERT(varchar(4), Year(DATEADD(month, -4, GetDate())))  AS Month_4,
--dbo.Get_TheMonth_Name (DATEADD(month, -3,GetDate()))+ ' ' + CONVERT(varchar(4), Year(DATEADD(month, -3, GetDate())))  AS Month_3,
--dbo.Get_TheMonth_Name (DATEADD(month, -2,GetDate()))+ ' ' + CONVERT(varchar(4), Year(DATEADD(month, -2, GetDate())))  AS Month_2,
--dbo.Get_TheMonth_Name (DATEADD(month, -1,GetDate()))+ ' ' + CONVERT(varchar(4), Year(DATEADD(month, -1, GetDate()))) AS Month_1,
--dbo.Get_TheMonth_Name (DATEADD(month, -0,GetDate()))+ ' ' + CONVERT(varchar(4), Year(GetDate())) AS Month_0

--UNION ALL

SELECT
"Month" = 'Magazine Customer Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Magazine'
AND tSO.Item_State IN ('RT', 'PS', 'SH')

UNION ALL

SELECT
"Month" = 'Magazine GR Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Magazine'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'GR'

UNION ALL

SELECT
"Month" = 'Magazine GR Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Magazine'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'GR'

UNION ALL

SELECT
"Month" = 'Magazine B1 Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Magazine'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B1'

UNION ALL

SELECT
"Month" = 'Magazine B1 Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Magazine'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B1'

UNION ALL

SELECT
"Month" = 'Magazine B2 Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Magazine'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B2'

UNION ALL

SELECT
"Month" = 'Magazine B2 Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Magazine'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B2'

UNION ALL

SELECT
"Month" = 'Magazine B3 Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Magazine'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B3'

UNION ALL

SELECT
"Month" = 'Magazine B3 Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Magazine'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B3'

UNION ALL

SELECT
"Month" = 'Magazine Other Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Magazine'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type NOT IN ('GR', 'B1', 'B2', 'B3')

UNION ALL

SELECT
"Month" = 'Magazine Other Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Magazine'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type NOT IN ('GR', 'B1', 'B2', 'B3')

UNION ALL


SELECT
"Month" = 'Newspaper Customer Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Newspaper'
AND tSO.Item_State IN ('RT', 'PS', 'SH')

UNION ALL

SELECT
"Month" = 'Newspaper GR Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Newspaper'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'GR'

UNION ALL

SELECT
"Month" = 'Newspaper GR Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Newspaper'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'GR'

UNION ALL

SELECT
"Month" = 'Newspaper B1 Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Newspaper'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B1'

UNION ALL

SELECT
"Month" = 'Newspaper B1 Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Newspaper'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B1'

UNION ALL

SELECT
"Month" = 'Newspaper B2 Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Newspaper'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B2'

UNION ALL

SELECT
"Month" = 'Newspaper B2 Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Newspaper'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B2'

UNION ALL

SELECT
"Month" = 'Newspaper B3 Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Newspaper'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B3'

UNION ALL

SELECT
"Month" = 'Newspaper B3 Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Newspaper'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B3'

UNION ALL

SELECT
"Month" = 'Newspaper Other Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Newspaper'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type NOT IN ('GR', 'B1', 'B2', 'B3')

UNION ALL

SELECT
"Month" = 'Newspaper Other Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Newspaper'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type NOT IN ('GR', 'B1', 'B2', 'B3')

UNION ALL


SELECT
"Month" = 'TV Customer Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')

UNION ALL

SELECT
"Month" = 'TV GR Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'GR'

UNION ALL

SELECT
"Month" = 'TV GR Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'GR'

UNION ALL

SELECT
"Month" = 'TV B1 Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B1'

UNION ALL

SELECT
"Month" = 'TV B1 Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B1'

UNION ALL

SELECT
"Month" = 'TV B2 Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B2'

UNION ALL

SELECT
"Month" = 'TV B2 Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B2'

UNION ALL

SELECT
"Month" = 'TV B3 Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B3'

UNION ALL

SELECT
"Month" = 'TV B3 Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B3'

UNION ALL

SELECT
"Month" = 'TV Other Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type NOT IN ('GR', 'B1', 'B2', 'B3')

UNION ALL

SELECT
"Month" = 'TV Other Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type NOT IN ('GR', 'B1', 'B2', 'B3')


UNION ALL


SELECT
"Month" = 'Spot TV Customer Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Spot TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')

UNION ALL

SELECT
"Month" = 'Spot TV GR Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Spot TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'GR'

UNION ALL

SELECT
"Month" = 'Spot TV GR Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Spot TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'GR'

UNION ALL

SELECT
"Month" = 'Spot TV B1 Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Spot TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B1'

UNION ALL

SELECT
"Month" = 'Spot TV B1 Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Spot TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B1'

UNION ALL

SELECT
"Month" = 'Spot TV B2 Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Spot TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B2'

UNION ALL

SELECT
"Month" = 'Spot TV B2 Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Spot TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B2'

UNION ALL

SELECT
"Month" = 'Spot TV B3 Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Spot TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B3'

UNION ALL

SELECT
"Month" = 'Spot TV B3 Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Spot TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type = 'B3'

UNION ALL

SELECT
"Month" = 'Spot TV Other Bullion Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type ='Bullion' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Spot TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type NOT IN ('GR', 'B1', 'B2', 'B3')

UNION ALL

SELECT
"Month" = 'Spot TV Other Bump Sales',
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_13 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_13,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_12 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_12,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_11 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_11,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_10 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_10,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_09 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_9,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_08 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_8,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_07 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_7,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_06 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_6,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_05 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_5,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_04 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_4,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_03 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_3,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_02 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_2,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_01 (GetDate()) AND tSO.Order_Date < dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_1,
SUM (CASE WHEN tSO.Order_Date >= dbo.Get_TheMonth_Previous_00 (GetDate()) AND tSO.Order_Date < dbo.Get_TheDate (GetDate()) AND tSO.Stock_Type <>'Bullion' AND tSO.Stock_Type <>'' THEN (tSO.Quantity_Ordered * tSO.Value_Ordered) ELSE 0 END) AS Month_0
FROM dbo.tbl_Customer_Sales_Statistics tCSS
LEFT OUTER JOIN dbo.tmp_Sales_Orders tSO
ON tCSS.Cust_ID=tSO.Cust_ID
WHERE tCSS.Campaign = 'Spot TV'
AND tSO.Item_State IN ('RT', 'PS', 'SH')
AND tCSS.Init_Buyer_Type NOT IN ('GR', 'B1', 'B2', 'B3')












